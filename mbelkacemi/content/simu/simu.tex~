\graphicspath{ {./content/simu/figure/} }

\section{\acl{ndt} based on punctual excitation}\label{sec:3}

\subsection{Non-through defect detection}\label{subsec:31}

In this section, the concept used to detect defect is presented and validated through simulation. Then, a specific image processing algorithm is developed to analyze the thermal evolution of each heated point. 

\subsubsection{Simulation}\label{subsec:311}

A 3D transient analysis is developed on COMSOL\textsuperscript{$\copyright$} software using \ac{fem}. The test object is a steel plate with \SI{10}{\milli \metre} thickness with the following properties: one face is flat while the other is degraded by non-through holes of \SI{10}{\milli \metre} diameter with different depths. A thermal simulation including thin insulating layer subjected to laser irradiation is carried out. 
A conductive heat transfer within the metal medium is simulated through the time dependent partial differential equation such as:

\begin{equation}
  \label{eq:1}
  \rho C_p \frac{\partial T}{\partial t} = \nabla \left[ k \nabla T  \right] + Q \ ,
\end{equation}

\noindent where $\rho$ is material density, $C_p$ is specific heat capacity, $T$ is temperature, $t$ is time, $k$ is thermal conductivity and $Q$ is a heat source term.
In our simulation, $Q$ has been set to $0$ and the metal medium is considered as opaque. The laser heat source is considered as an inward heat flux and characterized by a Gaussian representation such as:

\begin{equation}
  \label{eq:2}
  q_0 = \left( 2 \frac{P_L}{\pi r_{0}^{2}} \right) \exp \left( -2 \left( \frac{x^2 + y^2}{r_{0}^{2}} \right) \right) \ ,
\end{equation}

\noindent where $P_L$ is the laser power, $r_0$ is the laser beam waist, $x$ and $y$ are spatial coordinates.

\begin{figure}
  \centering
  \hspace*{\fill}
	\subfigure[]{\label{subfig:2a}\includegraphics[width=0.3\linewidth]{fig2ac.png}}\hfill
	\subfigure[]{\label{subfig:2b}\includegraphics[width=0.3\linewidth]{fig2c.png}} 
	\hspace*{\fill} \\ \hspace*{\fill}
	\subfigure[]{\label{subfig:2c}\includegraphics[width=0.3\linewidth]{fig2bc.png}}\hfill
	\subfigure[]{\label{subfig:2d}\includegraphics[width=0.3\linewidth]{fig2b.png}}
	\hspace*{\fill}
	\caption{(a) Cross-sectional view of the geometry - (b) 3D Thermal response to a laser 
	excitation - (c) Geometry and meshing (front side), dimensions appears in cm  - (d) 
	Geometry and meshing (back side).}
  \label{fig:2}
\end{figure}

Furthermore, the black paint layer is considered as a dielectric material so that the energy provided by the interaction between the laser beam and material involves an absorption coefficient $\alpha$, near 1.
Transient conduction analysis of $heat$ $transfer$ $module$ has been selected to solve heat equation. The 2D geometry of the problem is represented in Fig.\,\ref{subfig:2a} where $d$ is defect depth, $D$ is defect diameter. Boundary condition imposed to all surfaces is in form of the following equation:

\begin{equation}
  \label{eq:33}
  n(k \nabla T) = \alpha q_0 + h(T_{ext} - T) \ ,
\end{equation}

\noindent where $n$ is normal vector, $\alpha$ the absorption coefficient, $q_0$ is the inward heat flux equal on top surface and is equal to 0 on other surfaces, $h$ is a coefficient representing heat transfer losses due to convective heat flux with surrounding atmosphere. $h$ is equal to \SI{5}{\watt \per \square \metre \per \kelvin} on all surfaces except surfaces of the defect where h is chosen equal to 0 to simulate thermal insulation. Text is the surrounding atmosphere temperature. In the entire problem, radiation heat transfer losses are neglected. 

For meshing, free tetrahedral meshes are selected with choice of a custom element size. The maximum element size is equal to \SI{0.032}{\milli \metre} with a maximum element growth rate equal to 1.35. The smallest element size is obtained near to the origin (0, 0, 0) centrally located on top of the surface, see Fig.\,\ref{subfig:2c}. Due to presence on top surface of a thin layer with \SI{0.1}{\milli \metre} thickness, achieved finest meshing consists of around 75 000 till 225 000 elements for solving a system of around 111 000 till 324 000 degrees of freedom, depending of the chosen geometry. Record time stepping is selected to \SI{0.1}{\second} in a range from \SI{0}{\second} to \SI{2}{\second}. Geometric Multigrid GMRES iterative linear solver is used. Backward Differentiation Formula (BDF) implicit method is used to help solver to converge. At the beginning, use of free step BDF method results in smaller calculation time step size in the order of \SI{1}{\milli\second}. This kind of method is suitable for a heat flux starting problem.

The interaction of the laser beam with the solid surface produces a thermal wave propagating through the solid media. In the case of a media without any defects and assuming a semi-infinite and isotropic solid, the thermal response is defined by the shape of a symmetric hemisphere\cite{Li2011} as shown in Fig.\,\ref{subfig:2b}. This response is modified due to the presence of a defect close to the excited area.

The simulation results are depicted in Fig.\,\ref{subfig:3a}-\ref{subfig:3b}-\ref{subfig:3c} by representing the temperature profile in kelvin. It can be noted that the temperature intensity increases when the laser heats the defective area. Subsequently, the maximum temperature is reached for defects nearer to the surface. Fig.\,\ref{subfig:3d}-\ref{subfig:3e}-\ref{subfig:3f} represent the thermal response using another color-map. It can be observed that the amount of the thermal response increases due to the presence of inhomogeneities in the solid media.
	
  \begin{figure}
  \centering
  \hspace*{\fill}
  \subfigure[]{\label{subfig:3a}\includegraphics[width=0.3\linewidth]{fig2d.png}} \hfill
  \subfigure[]{\label{subfig:3b}\includegraphics[width=0.3\linewidth]{fig2e.png}} 
  \subfigure[]{\label{subfig:3c}\includegraphics[width=0.3\linewidth]{fig2f.png}} 
	\hspace*{\fill} \\ \hspace*{\fill}
  \subfigure[]{\label{subfig:3d}\includegraphics[width=0.3\linewidth]{1.png}} \hfill
  \subfigure[]{\label{subfig:3e}\includegraphics[width=0.3\linewidth]{2.png}} 
  \subfigure[]{\label{subfig:3f}\includegraphics[width=0.3\linewidth]{3.png}} 
  \hspace*{\fill}
  \caption{(a) and (d) Thermal response, observed on a non-defective area - (b) and (e) 
	Thermal response, observed on an area with defect of 1 mm below surface - (c) and (f) 
	Thermal response, 
	observed on an area with defect of 0.5 mm below surface.}
  \label{fig:3}
\end{figure}

\subsubsection{Defect detection algorithm}\label{subsec:312}

%Defect are characterized by a change of the heat distribution and therefore detected with appropriate image processing.
%The following process is performed to detect the defects. First, the object surface is punctually scanned using a laser beam and at each of these scans, thermal image is acquired. Subsequently, the image are pre-processed to ensure a robust defects segmentation by successively background subtraction to reduce the noise and contrast enhancing.

The difference between the heat-distribution in a defective region and a non-defective region allows us, through an appropriate image processing, to locate these defects.  
The defect detection procedure consists to perform a laser scan on object surface, and for each scan a thermal image is recorded. To allow a good detection of the thermal response shape, the image background is removed and a pre-processing is performed to reduce the image noise and to adjust the image contrast. The thermal response has circular shape as shown in Fig.\,\ref{subfig:44c}. We apply the region growing method\cite{Adams1994} to segment the thermal image. The initial seed points is selected on the circle center, i.e. the place where the thermal response is maximum. Then, the region grows if the difference of temperature values of the neighboring pixels and the region's mean is less than a certain maximum intensity distance. The pixel with the smallest difference is allocated to the region.
The number of white pixels is saved for each thermal image. This value is the unique characteristic of the excited area. To limit the influence of the emissivity change and detect robustly the defective area. The median $\tilde{s}$ is computed for each \ac{roi} with a size $(40\times40)$ scans and compared to each value $s(i,j)$ inside this \ac{roi} in order to binarize:

\begin{equation}
  \label{eq:3}
s_m(i,j) = \begin{cases}
1 & \quad \text{if } s(i,j) \geq K \times \tilde{s}\\
0 & \quad \text{if } s(i,j) < K \times \tilde{s}
\end{cases}
\end{equation}

\noindent where $K > 1$ and $s_m(i,j)$ is the resulting binary mask of the defects detection. 

If $K \gg 1$, the defect detection is more robust to noise. However, only shallowest defect are detected; if $K \to 1$, the defect detection is subject to noise. However, deeper defect are detected.

\input{./content/simu/figure/graph_detection_detect.tex}

% \begin{figure}
%   \centering
%   \hspace*{\fill}
%   {\includegraphics[width=0.5\linewidth]{fig5.png}}
%   \hspace*{\fill}
%   \caption{ Work flow of the defect detection method}
%   \label{fig:5}
% \end{figure}

\subsection{Fiber orientation assessment}\label{subsec:32}

Our approach to estimate the fiber orientations is based on the pulsed thermal ellipsometry approach\cite{Cielo1987}. Indeed, the thermal response of a polymer matrix composite material subjected to a laser beam is elliptic due to the propagation of the thermal wave through the fiber.
Thermal images are acquired with an IR camera and are pre-processed with the flowing steps:(i)segmentation using region growing and (ii)edge detection using canny edge detector\cite{Canny1986}. %obtained thanks to an IR camera are pre-processed and each image is first segmented using region growing to detect blobs follow by a Canny edge detector\cite{Canny1986}to find the border. 
The estimation of the fiber orientation is inferred by fitting an elliptical shape to the thermal response.
There are three methods of ellipse fitting commonly used: algebraic fitting\cite{Fitzgibbon1999}, orthogonal least squares fitting\cite{Ahn2001} and Maximum Likelihood algorithms\cite{Chojnacki2000}. 
The two latter methods are suitable for 3D data while the first method can only be applied to 2D problems. Whereas the low computational complexity of the algebraic fitting is suitable in this case. In this method, the ellipse is described by the general conic polynomial:

\begin{equation}
  \label{eq:4}
  F(a, X) = aX = 0 \,
\end{equation}

\noindent with 

\begin{eqnarray}
  a & = & \begin{bmatrix} A & B & C & D & E & F \\ \end{bmatrix}^\intercal \nonumber\\
  X & = & \begin{bmatrix} x^2 & xy & y^2 & x & y & 1 \\ \end{bmatrix}^\intercal \nonumber
\end{eqnarray}

The fitting is performed by a least square minimization of the Euclidean distances such that:

\begin{equation}
  \argmin{a} \sum_{i=1}^{n} \left( A x_i^2 + B x_i y_i + C y_i^2 + D x_i + E Y_i + F \right)^2 \ .
\end{equation}

The following constraint yields to one solution which corresponds to an ellipse:

\begin{equation}
  4AC - B^2 = 1 \ .
\end{equation}

%%% Local Variables: 
%%% mode: latex
%%% TeX-master: "../../master"
%%% End: 
